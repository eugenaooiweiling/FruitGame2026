<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fruit Addition 0-10</title>
    <style>
        /* --- 1. VISUAL STYLE (CSS) --- */
        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
            background-color: #f0f8ff;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden; /* Stops screen moving while dragging */
            touch-action: none; /* Crucial for iPad dragging */
        }

        /* The Header */
        header {
            background-color: #FF6B6B;
            color: white;
            width: 100%;
            padding: 10px;
            text-align: center;
            font-size: 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* The Game Area */
        #game-board {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 800px;
            flex-grow: 1;
            padding: 10px;
        }

        /* The Plates Table */
        .table-area {
            background-color: #e6c288; /* Wood color */
            border-radius: 15px;
            padding: 20px;
            width: 90%;
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
        }

        .plate {
            width: 130px;
            height: 130px;
            background-color: white;
            border-radius: 50%;
            border: 4px solid #ddd;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }

        /* The Fruit Bin (Where fruits start) */
        .fruit-bin {
            width: 90%;
            min-height: 80px;
            background-color: rgba(255, 255, 255, 0.6);
            border: 2px dashed #aaa;
            border-radius: 10px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            padding: 10px;
            gap: 10px;
        }

        /* The Draggable Fruit */
        .fruit {
            width: 50px;
            height: 50px;
            cursor: grab;
            position: relative; /* Needed for touch logic */
            z-index: 100;
            user-select: none;
            /* Using CSS gradients to draw simple fruits without images */
        }

        .apple {
            background: radial-gradient(circle at 30% 30%, #ff7b7b, #ff0000);
            border-radius: 50%;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .apple::after { /* Leaf */
            content: '';
            position: absolute;
            top: -5px; left: 20px;
            width: 10px; height: 10px;
            background: green;
            border-radius: 10px 0;
        }

        .orange {
            background: radial-gradient(circle at 30% 30%, #ffcd7b, #ffa500);
            border-radius: 50%;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        /* The Math Question Area */
        .math-section {
            margin-top: 20px;
            background: white;
            padding: 15px 30px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        input {
            width: 70px;
            height: 50px;
            font-size: 2rem;
            text-align: center;
            border: 3px solid #4ECDC4;
            border-radius: 10px;
        }

        button {
            background-color: #4ECDC4;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1.2rem;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 4px 0 #3aa8a0;
        }
        button:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* Feedback Modal */
        #modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-box {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
        }
    </style>
</head>
<body>

    <header>Count the Fruit! üçéüçä</header>

    <div id="game-board">
        <p id="progress-text">Question 1 of 10</p>
        
        <div class="table-area">
            <div class="plate" id="plate1"></div>
            <div class="plate" id="plate2"></div>
        </div>

        <div class="fruit-bin" id="bin"></div>

        <div class="math-section">
            <span id="num1">0</span>
            <span>+</span>
            <span id="num2">0</span>
            <span>=</span>
            <input type="number" id="answer" inputmode="numeric">
        </div>
        
        <br>
        <button onclick="checkAnswer()">Check Answer</button>
    </div>

    <div id="modal">
        <div class="modal-box">
            <h1 id="feedback-emoji">üåü</h1>
            <h2 id="feedback-text">Correct!</h2>
            <button onclick="nextQuestion()" id="next-btn">Next</button>
        </div>
    </div>

    <script>
        /* --- 2. THE BRAINS (JAVASCRIPT) --- */
        
        let qIndex = 0;
        let correctSum = 0;
        const totalQ = 10;
        
        // Setup Dragging Variables
        let draggedItem = null;
        let xOffset = 0, yOffset = 0;

        // Start Game on Load
        window.onload = function() {
            generateQuestion();
        };

        function generateQuestion() {
            // 1. Clear previous state
            document.getElementById('answer').value = '';
            document.getElementById('bin').innerHTML = '';
            
            // 2. Random Math (Sum <= 10)
            let n1 = Math.floor(Math.random() * 6); // 0-5
            let n2 = Math.floor(Math.random() * 6); // 0-5
            // Ensure sum isn't 0 and max is 10
            while(n1 + n2 === 0 || n1 + n2 > 10) {
                 n1 = Math.floor(Math.random() * 6);
                 n2 = Math.floor(Math.random() * 6);
            }
            correctSum = n1 + n2;

            // 3. Update Text
            document.getElementById('num1').innerText = n1;
            document.getElementById('num2').innerText = n2;
            document.getElementById('progress-text').innerText = `Question ${qIndex + 1} of ${totalQ}`;

            // 4. Create Fruits (Manipulatives)
            // We create 10 fruits total so kids have enough to drag
            const bin = document.getElementById('bin');
            for(let i=0; i<10; i++) {
                let f = document.createElement('div');
                f.className = (i % 2 === 0) ? 'fruit apple' : 'fruit orange';
                
                // Add Touch Logic
                f.addEventListener('touchstart', dragStart, {passive: false});
                f.addEventListener('touchmove', dragMove, {passive: false});
                f.addEventListener('touchend', dragEnd, {passive: false});
                
                // Add Mouse Logic (for desktop testing)
                f.addEventListener('mousedown', dragStart);
                
                bin.appendChild(f);
            }
        }

        /* --- DRAG & DROP LOGIC (Supports Touch & Mouse) --- */
        function dragStart(e) {
            draggedItem = e.target;
            
            // Get touch or mouse coordinates
            let clientX, clientY;
            if(e.type === 'touchstart') {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
                // Add mouse move listeners only when clicked
                document.addEventListener('mousemove', dragMove);
                document.addEventListener('mouseup', dragEnd);
            }

            // Calculate offset so item doesn't "jump" to cursor center
            let rect = draggedItem.getBoundingClientRect();
            xOffset = clientX - rect.left;
            yOffset = clientY - rect.top;

            // Prepare item for moving
            draggedItem.style.position = 'absolute';
            draggedItem.style.zIndex = 1000;
            document.body.appendChild(draggedItem); // Move to body to float above everything
            
            moveItem(clientX, clientY);
        }

        function dragMove(e) {
            e.preventDefault(); // Stop screen scrolling
            let clientX, clientY;
            
            if(e.type === 'touchmove') {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }
            
            moveItem(clientX, clientY);
        }

        function moveItem(x, y) {
            if(!draggedItem) return;
            draggedItem.style.left = (x - xOffset) + 'px';
            draggedItem.style.top = (y - yOffset) + 'px';
        }

        function dragEnd(e) {
            // Cleanup
            draggedItem = null;
            document.removeEventListener('mousemove', dragMove);
            document.removeEventListener('mouseup', dragEnd);
        }

        /* --- GAME LOGIC --- */
        function checkAnswer() {
            let userAns = parseInt(document.getElementById('answer').value);
            let modal = document.getElementById('modal');
            let emoji = document.getElementById('feedback-emoji');
            let txt = document.getElementById('feedback-text');
            let btn = document.getElementById('next-btn');

            modal.style.display = 'flex';

            if(userAns === correctSum) {
                emoji.innerText = "üåü";
                txt.innerText = "Correct!";
                btn.innerText = "Next Question";
                btn.onclick = nextQuestion;
            } else {
                emoji.innerText = "ü§î";
                txt.innerText = "Try Again";
                btn.innerText = "Close";
                btn.onclick = function() { modal.style.display = 'none'; };
            }
        }

        function nextQuestion() {
            document.getElementById('modal').style.display = 'none';
            qIndex++;
            if(qIndex < totalQ) {
                generateQuestion();
            } else {
                // End of Game
                document.getElementById('game-board').innerHTML = "<h1>Good job! You finished! üéâ</h1><button onclick='location.reload()'>Play Again</button>";
            }
        }
    </script>
</body>
</html>
